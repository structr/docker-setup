version: '3.3'
services:  
  neo4j:
    image: neo4j:latest

    environment:
      - NEO4J_AUTH=neo4j/structr

    networks:
      structr-net:
        aliases:
          - neo4j
  structr:
    image: structr/structr:4.0-SNAPSHOT
    depends_on:
      - neo4j
    ports:
     - "8082:8082"
    environment:
      - AGREE_TO_STRUCTR_PRIVACY_POLICY=yes

    volumes:
      - ./structr/structr.conf:/var/lib/structr/structr.conf
      - ./structr/license.key:/var/lib/structr/license.key
      - ./structr/memory.config:/var/lib/structr/bin/memory.config

    networks:
      structr-net:
        aliases:
          - structr

  structr-autodeploy:
    build: ./structr-autodeploy
    depends_on:
      - structr
    environment:
      - HOST=structr:8082
      - APP_ZIP_URL=
      - DATA_ZIP_URL=
      - STRUCTR_SUPERADMIN_PASSWORD=structrSuperuser
    networks:
      structr-net:

networks:
  structr-net:
